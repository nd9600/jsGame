!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="static/js/",n(n.s=1)}([,function(t,e,n){"use strict";var r,o;n.r(e),function(t){t.Character="c",t.Wall="x",t.Empty=" ",t.End="e"}(r||(r={})),function(t){t.NotStarted="NotStarted",t.PlacingWalls="PlacingWalls",t.Playing="Playing",t.Finished="Finished"}(o||(o={}));var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return a(t,null,[{key:"mergeWithOptions",value:function(t,e){return new dt(t.id,t.creatorID,e.boardData||t.boardData,e.startPoint||t.startPoint,e.endPoint||t.endPoint,e.status||t.status)}}]),t}();function u(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function c(t){return function e(n){return 0===arguments.length||u(n)?e:t.apply(this,arguments)}}function s(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return u(n)?e:c(function(e){return t(n,e)});default:return u(n)&&u(r)?e:u(n)?c(function(e){return t(e,r)}):u(r)?c(function(e){return t(n,e)}):t(n,r)}}}var f=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function l(t,e,n){return function(){if(0===arguments.length)return n();var r=Array.prototype.slice.call(arguments,0),o=r.pop();if(!f(o)){for(var a=0;a<t.length;){if("function"==typeof o[t[a]])return o[t[a]].apply(o,r);a+=1}if(function(t){return null!=t&&"function"==typeof t["@@transducer/step"]}(o))return e.apply(null,r)(o)}return n.apply(this,arguments)}}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}function y(t){return"[object String]"===Object.prototype.toString.call(t)}var h=c(function(t){return!!f(t)||!!t&&("object"==typeof t&&(!y(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),d=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},t}();function v(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,r){return e.apply(this,arguments)};case 4:return function(t,n,r,o){return e.apply(this,arguments)};case 5:return function(t,n,r,o,a){return e.apply(this,arguments)};case 6:return function(t,n,r,o,a,i){return e.apply(this,arguments)};case 7:return function(t,n,r,o,a,i,u){return e.apply(this,arguments)};case 8:return function(t,n,r,o,a,i,u,c){return e.apply(this,arguments)};case 9:return function(t,n,r,o,a,i,u,c,s){return e.apply(this,arguments)};case 10:return function(t,n,r,o,a,i,u,c,s,f){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}var b=s(function(t,e){return v(t.length,function(){return t.apply(e,arguments)})});function g(t,e,n){for(var r=n.next();!r.done;){if((e=t["@@transducer/step"](e,r.value))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r=n.next()}return t["@@transducer/result"](e)}function w(t,e,n,r){return t["@@transducer/result"](n[r](b(t["@@transducer/step"],t),e))}var m="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function O(t,e,n){if("function"==typeof t&&(t=function(t){return new d(t)}(t)),h(n))return function(t,e,n){for(var r=0,o=n.length;r<o;){if((e=t["@@transducer/step"](e,n[r]))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r+=1}return t["@@transducer/result"](e)}(t,e,n);if("function"==typeof n["fantasy-land/reduce"])return w(t,e,n,"fantasy-land/reduce");if(null!=n[m])return g(t,e,n[m]());if("function"==typeof n.next)return g(t,e,n);if("function"==typeof n.reduce)return w(t,e,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var P=function(){return this.xf["@@transducer/init"]()},j=function(t){return this.xf["@@transducer/result"](t)},_=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=P,t.prototype["@@transducer/result"]=j,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},t}(),E=s(function(t,e){return new _(t,e)});function S(t,e){return Object.prototype.hasOwnProperty.call(e,t)}var k=Object.prototype.toString,x=function(){return"[object Arguments]"===k.call(arguments)?function(t){return"[object Arguments]"===k.call(t)}:function(t){return S("callee",t)}}(),C=!{toString:null}.propertyIsEnumerable("toString"),T=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],D=function(){return arguments.propertyIsEnumerable("length")}(),I=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},A="function"!=typeof Object.keys||D?c(function(t){if(Object(t)!==t)return[];var e,n,r=[],o=D&&x(t);for(e in t)!S(e,t)||o&&"length"===e||(r[r.length]=e);if(C)for(n=T.length-1;n>=0;)S(e=T[n],t)&&!I(r,e)&&(r[r.length]=e),n-=1;return r}):c(function(t){return Object(t)!==t?[]:Object.keys(t)}),B=s(l(["filter"],E,function(t,e){return p(e)?O(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{},A(e)):function(t,e){for(var n=0,r=e.length,o=[];n<r;)t(e[n])&&(o[o.length]=e[n]),n+=1;return o}(t,e)}));function M(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function N(t,e,n){for(var r=0,o=n.length;r<o;){if(t(e,n[r]))return!0;r+=1}return!1}var W="function"==typeof Object.is?Object.is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e},R=c(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function F(t,e,n,r){var o=M(t);function a(t,e){return U(t,e,n.slice(),r.slice())}return!N(function(t,e){return!N(a,e,t)},M(e),o)}function U(t,e,n,r){if(W(t,e))return!0;var o,a,i=R(t);if(i!==R(e))return!1;if(null==t||null==e)return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(i){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===(o=t.constructor,null==(a=String(o).match(/^function (\w*)/))?"":a[1]))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!W(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!W(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var u=n.length-1;u>=0;){if(n[u]===t)return r[u]===e;u-=1}switch(i){case"Map":return t.size===e.size&&F(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&F(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var c=A(t);if(c.length!==A(e).length)return!1;var s=n.concat([t]),f=r.concat([e]);for(u=c.length-1;u>=0;){var l=c[u];if(!S(l,e)||!U(e[l],t[l],s,f))return!1;u-=1}return!0}var L=s(function(t,e){return U(t,e,[],[])});function q(){}var z={range:function(t,e){var n=Math.min(t,e),r=Math.max(t,e),o=Array.from({length:r-n},function(t,e){return e+n});return e<t?o.reverse():o},makeError:function(t,e){return{name:t,message:e}},errorHandler:function(t){},assertUnreachable:function(t){throw new Error("Didn't expect to get here")},abyss:q,countNumberOf:function(t,e){return B(L(t),e).length}};function G(t,e,n){return function(){for(var r=[],o=0,a=t,i=0;i<e.length||o<arguments.length;){var c;i<e.length&&(!u(e[i])||o>=arguments.length)?c=e[i]:(c=arguments[o],o+=1),r[i]=c,u(c)||(a-=1),i+=1}return a<=0?n.apply(this,r):v(a,G(t,r,n))}}var H=s(function(t,e){return 1===t?c(e):v(t,G(t,[],e))}),J=c(function(t){return H(t.length,t)}),X=s(function(t,e){var n=t<0?e.length+t:t;return y(e)?e.charAt(n):e[n]});function Y(t){return function e(n){for(var r,o,a,i=[],u=0,c=n.length;u<c;){if(h(n[u]))for(a=0,o=(r=t?e(n[u]):n[u]).length;a<o;)i[i.length]=r[a],a+=1;else i[i.length]=n[u];u+=1}return i}}var Z=c(Y(!0));function $(t,e){var n;e=e||[];var r=(t=t||[]).length,o=e.length,a=[];for(n=0;n<r;)a[a.length]=t[n],n+=1;for(n=0;n<o;)a[a.length]=e[n],n+=1;return a}var K=s(function(t,e){return $([t],e)});function Q(t){return function e(n,r,o){switch(arguments.length){case 0:return e;case 1:return u(n)?e:s(function(e,r){return t(n,e,r)});case 2:return u(n)&&u(r)?e:u(n)?s(function(e,n){return t(e,r,n)}):u(r)?s(function(e,r){return t(n,e,r)}):c(function(e){return t(n,r,e)});default:return u(n)&&u(r)&&u(o)?e:u(n)&&u(r)?s(function(e,n){return t(e,n,o)}):u(n)&&u(o)?s(function(e,n){return t(e,r,n)}):u(r)&&u(o)?s(function(e,r){return t(n,e,r)}):u(n)?c(function(e){return t(e,r,o)}):u(r)?c(function(e){return t(n,e,o)}):u(o)?c(function(e){return t(n,r,e)}):t(n,r,o)}}}var V=Q(function(t,e,n){for(var r=[],o=0,a=Math.min(e.length,n.length);o<a;)r[o]=t(e[o],n[o]),o+=1;return r});function tt(t,e){for(var n=0,r=e.length,o=Array(r);n<r;)o[n]=t(e[n]),n+=1;return o}var et=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=P,t.prototype["@@transducer/result"]=j,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),nt=s(l(["fantasy-land/map","map"],s(function(t,e){return new et(t,e)}),function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return H(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return O(function(n,r){return n[r]=t(e[r]),n},{},A(e));default:return tt(t,e)}}));function rt(t,e){return function(t,e,n){var r,o;if("function"==typeof t.indexOf)switch(typeof e){case"number":if(0===e){for(r=1/e;n<t.length;){if(0===(o=t[n])&&1/o===r)return n;n+=1}return-1}if(e!=e){for(;n<t.length;){if("number"==typeof(o=t[n])&&o!=o)return n;n+=1}return-1}return t.indexOf(e,n);case"string":case"boolean":case"function":case"undefined":return t.indexOf(e,n);case"object":if(null===e)return t.indexOf(e,n)}for(;n<t.length;){if(L(t[n],e))return n;n+=1}return-1}(e,t,0)>=0}function ot(t){return'"'+t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var at=function(t){return(t<10?"0":"")+t},it="function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+at(t.getUTCMonth()+1)+"-"+at(t.getUTCDate())+"T"+at(t.getUTCHours())+":"+at(t.getUTCMinutes())+":"+at(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};var ut=s(function(t,e){return B((n=t,function(){return!n.apply(this,arguments)}),e);var n});var ct=c(function(t){return function t(e,n){var r=function(r){var o=n.concat([e]);return rt(r,o)?"<Circular>":t(r,o)},o=function(t,e){return tt(function(e){return ot(e)+": "+r(t[e])},e.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+tt(r,e).join(", ")+"))";case"[object Array]":return"["+tt(r,e).concat(o(e,ut(function(t){return/^\d+$/.test(t)},A(e)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof e?"new Boolean("+r(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?r(NaN):ot(it(e)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof e?"new Number("+r(e.valueOf())+")":1/e==-1/0?"-0":e.toString(10);case"[object String]":return"object"==typeof e?"new String("+r(e.valueOf())+")":ot(e);case"[object Undefined]":return"undefined";default:if("function"==typeof e.toString){var a=e.toString();if("[object Object]"!==a)return a}return"{"+o(e,A(e)).join(", ")+"}"}}(t,[])}),st=s(function(t,e){return H(t+1,function(){var n,r=arguments[t];if(null!=r&&(n=r[e],"[object Function]"===Object.prototype.toString.call(n)))return r[e].apply(r,Array.prototype.slice.call(arguments,0,t));throw new TypeError(ct(r)+' does not have a method named "'+e+'"')})})(1,"join"),ft=Q(function(t,e,n){if(t>=n.length||t<-n.length)return n;var r=(t<0?n.length:0)+t,o=$(n);return o[r]=e(n[r]),o}),lt=c(function(t){return function(){return t}}),pt=Q(function(t,e,n){return ft(t,lt(e),n)}),yt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var ht=function(){function t(e,n,a,i,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.NotStarted;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.creatorID=n,this.boardData=a,this.startPoint=i,this.endPoint=u,this.status=c,this.getPosition=J(this.uncurriedGetPosition),this.setPosition=J(this.uncurriedSetPosition),this.numberOfRows=this.boardData.length,this.numberOfColumns=X(0,this.boardData).length,this.maxNumberOfWalls=Math.floor(this.numberOfRows*this.numberOfColumns*t.MAX_NUMBER_OF_WALLS_FACTOR),this.currentNumberOfWalls=z.countNumberOf(r.Wall,Z(this.boardData))}return yt(t,[{key:"boardAsString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\n",e=z.range(0,this.numberOfRows),n=z.range(0,this.numberOfColumns),r=V(function(t,e){return K(String(t),e)},e,this.boardData),o=nt(st(" "),r),a=st(t,o),i="  "+st(" ",n)+"\n";return st("",[i,a])}},{key:"getCurrentInfo",value:function(){return"Board #"+this.id+"\nStart point: "+JSON.stringify(this.startPoint)+"\nEnd point: "+JSON.stringify(this.endPoint)+"\nBoard:\n"+this.boardAsString()+"\n"}},{key:"setStartPoint",value:function(t){return i.mergeWithOptions(this,{startPoint:t})}},{key:"setEndPoint",value:function(t){return i.mergeWithOptions(this,{endPoint:t})}},{key:"setStatus",value:function(t){return i.mergeWithOptions(this,{status:t})}},{key:"toggleWallAtPosition",value:function(t){if(this.status!==o.PlacingWalls)return this;if(L(t,this.startPoint)||L(t,this.endPoint))return this;var e=this.getPosition(t);return e!==r.Wall&&e!==r.Empty?this:e===r.Wall?this.setPosition(t,r.Empty):this.currentNumberOfWalls<this.maxNumberOfWalls?this.setPosition(t,r.Wall):this}},{key:"uncurriedGetPosition",value:function(t){var e=X(t.y,this.boardData);return X(t.x,e)}},{key:"uncurriedSetPosition",value:function(t,e){var n=X(t.y,this.boardData),r=pt(t.x,e,n),o=pt(t.y,r,this.boardData);return i.mergeWithOptions(this,{boardData:o})}}]),t}(),dt=ht;ht.idCounter=0,ht.MAX_NUMBER_OF_WALLS_FACTOR=.5;var vt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var bt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Event",this.types=[this.type],this.data=e}return vt(t,[{key:"handle",value:function(t){return t}}],[{key:"dispatch",value:function(t,e,n){window.eventBus&&window.eventBus.dispatchToAllListeners(t,e,n)}}]),t}(),gt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function wt(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var mt,Ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return gt(t,null,[{key:"makeInitialBoard",value:function(t){var e=t[0],n=t[1],o=nt(lt(r.Empty),[].concat(wt(Array(n))));return nt(lt(o),[].concat(wt(Array(e))))}}]),t}();!function(t){t.Playing="Playing",t.Solved="Solved",t.Finished="Finished"}(mt||(mt={}));var Pt=s(function(t,e){for(var n=e,r=0;r<t.length;){if(null==n)return;n=n[t[r]],r+=1}return n}),jt=s(function(t,e){return Pt([t],e)}),_t=s(function(t,e){return nt(jt(t),e)}),Et=c(function(t){for(var e=A(t),n=e.length,r=[],o=0;o<n;)r[o]=t[e[o]],o+=1;return r}),St=s(rt);function kt(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}}var xt=function(){function t(t,e){this.xf=e,this.f=t,this.all=!0}return t.prototype["@@transducer/init"]=P,t.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)||(this.all=!1,t=kt(this.xf["@@transducer/step"](t,!1))),t},t}(),Ct=s(l(["all"],s(function(t,e){return new xt(t,e)}),function(t,e){for(var n=0;n<e.length;){if(!t(e[n]))return!1;n+=1}return!0})),Tt=Q(function(t,e,n){var r={};for(var o in n)r[o]=n[o];return r[t]=e,r}),Dt=Number.isInteger||function(t){return t<<0===t},It=c(function(t){return null==t}),At=Q(function t(e,n,r){if(0===e.length)return n;var o=e[0];if(e.length>1){var a=!It(r)&&S(o,r)?r[o]:Dt(e[1])?[]:{};n=t(Array.prototype.slice.call(e,1),n,a)}if(Dt(o)&&f(r)){var i=[].concat(r);return i[o]=n,i}return Tt(o,n,r)}),Bt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Mt=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.players=e,this.boards=n,this.playerBoards=r;var a=_t("status",Et(n));St(o.NotStarted,a)?this.status=o.NotStarted:Ct(L(o.PlacingWalls),a)?this.status=o.PlacingWalls:Ct(L(o.Playing),a)?this.status=o.Playing:this.status=o.Finished}return Bt(t,[{key:"getPlayerBoard",value:function(t,e){var n=jt(t,this.playerBoards);return jt(e,n)}},{key:"replacePlayer",value:function(e){return new t(Tt(e.id,e,this.players),this.boards,this.playerBoards)}},{key:"replaceBoard",value:function(e){var n=Tt(e.id,e,this.boards);return new t(this.players,n,this.playerBoards)}},{key:"replacePlayerBoard",value:function(e){var n=e.playerID,r=e.boardID,o=At([n,r],e,this.playerBoards);return new t(this.players,this.boards,o)}},{key:"getCurrentInfo",value:function(){var t="",e=!0,n=!1,r=void 0;try{for(var o,a=Et(this.boards)[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){t=""+t+o.value.getCurrentInfo()+"\n"}}catch(t){n=!0,r=t}finally{try{!e&&a.return&&a.return()}finally{if(n)throw r}}var i=!0,u=!1,c=void 0;try{for(var s,f=Et(this.players)[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var l=s.value;t=t+"#####\n"+l.getCurrentInfo()+"\n";var p=jt(l.id,this.playerBoards),y=!0,h=!1,d=void 0;try{for(var v,b=Et(p)[Symbol.iterator]();!(y=(v=b.next()).done);y=!0){t=""+t+v.value.getCurrentInfo()+"\n"}}catch(t){h=!0,d=t}finally{try{!y&&b.return&&b.return()}finally{if(h)throw d}}}}catch(t){u=!0,c=t}finally{try{!i&&f.return&&f.return()}finally{if(u)throw c}}return t}}]),t}(),Nt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Wt=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=e,this.name=n,this.score=r}return Nt(t,[{key:"getCurrentInfo",value:function(){return"Player #"+this.id+", "+this.name+", "+this.score+" points\n"}}]),t}(),Rt=Wt;Wt.idCounter=0;var Ft=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ut=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.playerID=e,this.boardID=n,this.characterPosition=r,this.boardStatus=o}return Ft(t,[{key:"getCurrentInfo",value:function(){return"Player #"+this.playerID+", Board #"+this.boardID+"\nCharacter position: "+JSON.stringify(this.characterPosition)+"\nBoard Status: "+this.boardStatus+"\n"}}]),t}(),Lt=function(){function t(t,e,n,r){this.valueFn=t,this.valueAcc=e,this.keyFn=n,this.xf=r,this.inputs={}}return t.prototype["@@transducer/init"]=P,t.prototype["@@transducer/result"]=function(t){var e;for(e in this.inputs)if(S(e,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[e]))["@@transducer/reduced"]){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var n=this.keyFn(e);return this.inputs[n]=this.inputs[n]||[n,this.valueAcc],this.inputs[n][1]=this.valueFn(this.inputs[n][1],e),t},t}(),qt=G(4,[],l([],G(4,[],function(t,e,n,r){return new Lt(t,e,n,r)}),function(t,e,n,r){return O(function(r,o){var a=n(o);return r[a]=t(S(a,r)?r[a]:e,o),r},{},r)}))(function(t,e){return e},null),zt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Gt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return zt(t,null,[{key:"defaultPlayer",value:function(){return new Rt(Rt.idCounter++,"",0)}},{key:"defaultBoard",value:function(e){return new dt(dt.idCounter++,e,[[]],t.defaultPosition,t.defaultEndPosition)}},{key:"createGameState",value:function(e){var n=e&&e.players?e.players:[this.defaultPlayer()],r=e&&e.boards?e.boards:[this.defaultBoard(n[0].id)],o=t.createPlayersObject(n),a=t.createBoardsObject(r),i=t.createPlayerBoardsObject(o,a);return new Mt(o,a,i)}},{key:"createPlayerBoardsObject",value:function(t,e){var n={},r=!0,a=!1,i=void 0;try{for(var u,c=Object.keys(t)[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var s=u.value,f=Number(s),l={},p=!0,y=!1,h=void 0;try{for(var d,v=Object.keys(e)[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var b=d.value,g=Number(b),w=jt(g,e),m=new Ut(f,g,w.startPoint,w.status===o.Finished?mt.Solved:mt.Playing);l[g]=m}}catch(t){y=!0,h=t}finally{try{!p&&v.return&&v.return()}finally{if(y)throw h}}n[f]=l}}catch(t){a=!0,i=t}finally{try{!r&&c.return&&c.return()}finally{if(a)throw i}}return n}},{key:"createBoardsObject",value:function(t){return qt(function(t){return t.id},t)}},{key:"createPlayersObject",value:function(t){return qt(function(t){return t.id},t)}}]),t}(),Ht=Gt;Gt.defaultPosition={x:0,y:0},Gt.defaultEndPosition={x:1,y:1};var Jt=s(function(t,e){return $(e,[t])}),Xt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Yt=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type="InitialSetupEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,bt),Xt(e,[{key:"handle",value:function(t){var e=new Rt(this.data.playerIDs[0],this.data.initialPlayerName,0),n=new Rt(this.data.playerIDs[1],this.data.initialPlayerName,0),r=Ot.makeInitialBoard(this.data.size),o=new dt(this.data.boardIDs[0],e.id,r,this.data.startPoint,this.data.endPoint),a=new dt(this.data.boardIDs[1],n.id,r,this.data.startPoint,this.data.endPoint),i=Ht.createPlayersObject([e,n]),u=Ht.createBoardsObject([o,a]),c=Ht.createPlayerBoardsObject(i,u);return new Mt(i,u,c)}}]),e}(),Zt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var $t=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Zt(t,[{key:"getInitialPlayerName",value:function(){return""}},{key:"getSize",value:function(){return[4,4]}},{key:"getStartPoint",value:function(){return{x:0,y:0}}},{key:"getEndPoint",value:function(){return{x:3,y:3}}},{key:"getPlayerIDs",value:function(){return[0,1]}},{key:"getBoardIDs",value:function(){return[0,1]}}]),t}(),Kt=s(function(t,e){if(0===t.length)return!1;for(var n=e,r=0;r<t.length;){if(!S(t[r],n))return!1;n=n[t[r]],r+=1}return!0}),Qt=s(function(t,e){return Kt([t],e)}),Vt=s(function(t,e){return"function"==typeof e["fantasy-land/ap"]?e["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(e):"function"==typeof t?function(n){return t(n)(e(n))}:O(function(t,n){return $(t,nt(n,e))},[],t)}),te=s(function(t,e){var n=H(t,e);return H(t,function(){return O(Vt,nt(n,arguments[0]),Array.prototype.slice.call(arguments,1))})}),ee=c(function(t){return te(t.length,t)})(c(function(t){return!t}));function ne(t,e){return function(){var n=arguments.length;if(0===n)return e();var r=arguments[n-1];return f(r)||"function"!=typeof r[t]?e.apply(this,arguments):r[t].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var re=s(ne("forEach",function(t,e){for(var n=e.length,r=0;r<n;)t(e[r]),r+=1;return e})),oe=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var ae,ie,ue=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.unCaughtEvents=[],this.listeners={default:[function(t){e.unCaughtEvents=Jt(t,e.unCaughtEvents)}]}}return oe(t,[{key:"addListener",value:function(t,e){var n=void 0;if(Qt(t,this.listeners)){var r=this.listeners[t];n=Jt(e,r)}else n=[e];this.listeners=Tt(t,n,this.listeners)}},{key:"removeListener",value:function(t,e){var n=void 0;if(Qt(t,this.listeners)){var r=this.listeners[t];n=ut(ee(L(e.toString())),r)}else n=[];this.listeners=Tt(t,n,this.listeners)}},{key:"dispatch",value:function(t,e){if(Qt(t,this.listeners)){var n=this.listeners[t];re(function(t){t(e)},n)}else this.unCaughtEvents=Jt(e,this.unCaughtEvents)}},{key:"getListeners",value:function(){return this.listeners}},{key:"getUncaughtEvents",value:function(){return this.unCaughtEvents}},{key:"dispatchToAllListeners",value:function(t,e,n){var r=this;window.eventBus&&re(function(t){r.dispatch(t,{type:e,data:n})},t)}},{key:"addListenerToMultipleEvents",value:function(t,e){var n=this;re(function(t){n.addListener(t,e)},t)}}]),t}();!function(t){t.MoveUp="MoveUp",t.MoveDown="MoveDown",t.MoveLeft="MoveLeft",t.MoveRight="MoveRight"}(ae||(ae={})),function(t){t.Up="Up",t.Down="Down",t.Left="Left",t.Right="Right"}(ie||(ie={}));var ce=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="MovementEvent",n.types=Jt(n.type,n.types),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,bt),e}(),se=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var fe=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type="FailedMovementEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,ce),se(e,[{key:"handle",value:function(t){return z.errorHandler(this.data),function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,n,r)}if("value"in o)return o.value;var i=o.get;return void 0!==i?i.call(r):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"handle",this).call(this,t)}}]),e}(),le=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var pe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return le(t,null,[{key:"mergeWithOptions",value:function(t,e){return new Ut(t.playerID,t.boardID,e.characterPosition||t.characterPosition,e.boardStatus||t.boardStatus)}}]),t}(),ye=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var he=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type="SuccessfulMovementEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,ce),ye(e,[{key:"handle",value:function(t){var e=t.getPlayerBoard(this.data.playerID,this.data.boardID),n=t.boards[this.data.boardID],r=L(this.data.newCharacterPosition,n.endPoint);return t.replacePlayerBoard(pe.mergeWithOptions(e,{characterPosition:this.data.newCharacterPosition,boardStatus:r?mt.Solved:mt.Playing}))}}]),e}(),de=c(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():f(t)?[]:y(t)?"":p(t)?{}:x(t)?function(){return arguments}():void 0}),ve=c(function(t){return null!=t&&L(t,de(t))}),be=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.found=!1}return t.prototype["@@transducer/init"]=P,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.found=!0,t=kt(this.xf["@@transducer/step"](t,this.idx))),t},t}(),ge=s(l([],s(function(t,e){return new be(t,e)}),function(t,e){for(var n=0,r=e.length;n<r;){if(t(e[n]))return n;n+=1}return-1}));function we(t,e,n){if(ve(t))return new fe(z.makeError("MovementError","no positions to move in to"));var o=ge(function(t){return L(e.getPosition(t),r.Wall)},t),a=void 0;return 0===o?new fe(z.makeError("MovementError","wall immediately beside")):(a=-1===o?t[t.length-1]:t[o-1],new he({boardID:e.id,playerID:n.playerID,newCharacterPosition:a}))}function me(t,e,n){var r=e.characterPosition;switch(n){case ie.Up:if(0===r.y)return new fe(z.makeError("MovementError","at top of board"));var o=z.range(r.y,0);return we(nt(function(t){return Tt("y",t,r)},o),t,e);case ie.Down:if(r.y+1===t.numberOfRows)return new fe(z.makeError("MovementError","at bottom of board"));var a=z.range(r.y+1,t.numberOfRows);return we(nt(function(t){return Tt("y",t,r)},a),t,e);case ie.Left:if(0===r.x)return new fe(z.makeError("MovementError","at left of board"));var i=z.range(r.x,0);return we(nt(function(t){return Tt("x",t,r)},i),t,e);case ie.Right:if(r.x+1===t.numberOfColumns)return new fe(z.makeError("MovementError","at right of board"));var u=z.range(r.x+1,t.numberOfColumns);return we(nt(function(t){return Tt("x",t,r)},u),t,e)}return z.assertUnreachable(n)}var Oe={getPositionToMoveInto:function(t,e,n){var r=Et(t.boards);return nt(function(r){return me(r,t.getPlayerBoard(e.id,r.id),n)},r)},getPositionToMoveIntoForBoard:me};var Pe=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="CommandEvent",n.types=Jt(n.type,n.types),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,bt),e}(),je=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var _e=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="EndPointChangeEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),je(e,[{key:"handle",value:function(t){var e=t.boards[this.data.boardID].setEndPoint(this.data.newEndPoint);return t.replaceBoard(e)}}]),e}(),Ee=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Se=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Ee(t,null,[{key:"mergeWithOptions",value:function(t,e){return new Rt(t.id,e.name||t.name,e.score||t.score)}}]),t}(),ke=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var xe=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="PlayerNameChangeEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),ke(e,[{key:"handle",value:function(t){var e=t.players[this.data.playerID],n=Se.mergeWithOptions(e,{name:this.data.newPlayerName});return t.replacePlayer(n)}}]),e}();function Ce(t,e,n){var r,o=typeof t;switch(o){case"string":case"number":return 0===t&&1/t==-1/0?!!n._items["-0"]||(e&&(n._items["-0"]=!0),!1):null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):o in n._items?t in n._items[o]||(e&&(n._items[o][t]=!0),!1):(e&&(n._items[o]={},n._items[o][t]=!0),!1);case"boolean":if(o in n._items){var a=t?1:0;return!!n._items[o][a]||(e&&(n._items[o][a]=!0),!1)}return e&&(n._items[o]=t?[!1,!0]:[!0,!1]),!1;case"function":return null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):o in n._items?!!rt(t,n._items[o])||(e&&n._items[o].push(t),!1):(e&&(n._items[o]=[t]),!1);case"undefined":return!!n._items[o]||(e&&(n._items[o]=!0),!1);case"object":if(null===t)return!!n._items.null||(e&&(n._items.null=!0),!1);default:return(o=Object.prototype.toString.call(t))in n._items?!!rt(t,n._items[o])||(e&&n._items[o].push(t),!1):(e&&(n._items[o]=[t]),!1)}}var Te=function(){function t(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return t.prototype.add=function(t){return!Ce(t,!0,this)},t.prototype.has=function(t){return Ce(t,!1,this)},t}(),De=s(function(t,e){for(var n=[],r=0,o=t.length,a=e.length,i=new Te,u=0;u<a;u+=1)i.add(e[u]);for(;r<o;)i.add(t[r])&&(n[n.length]=t[r]),r+=1;return n}),Ie=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ae=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="SetPlayerBoardStatusToFinishedEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),Ie(e,[{key:"handle",value:function(t){var e=t.getPlayerBoard(this.data.playerID,this.data.boardID),n=t.replacePlayerBoard(pe.mergeWithOptions(e,{boardStatus:mt.Finished})),r=!0,o=!0,a=!1,i=void 0;try{for(var u,c=Et(n.players)[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var s=u.value,f=jt(s.id,n.playerBoards),l=!0,p=!1,y=void 0;try{for(var h,d=Et(f)[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){h.value.boardStatus!==mt.Finished&&(r=!1)}}catch(t){p=!0,y=t}finally{try{!l&&d.return&&d.return()}finally{if(p)throw y}}}}catch(t){a=!0,i=t}finally{try{!o&&c.return&&c.return()}finally{if(a)throw i}}if(r){var v=A(n.players),b=!0,g=!1,w=void 0;try{for(var m,O=Et(n.boards)[Symbol.iterator]();!(b=(m=O.next()).done);b=!0){var P=m.value,j=P.creatorID,_=Number(De(v,[String(j)])[0]),E=L(n.getPlayerBoard(j,P.id).characterPosition,P.endPoint),S=L(n.getPlayerBoard(_,P.id).characterPosition,P.endPoint),k=E&&!S?10:E&&S?5:0;if(k>0){var x=jt(j,n.players);n=n.replacePlayer(Se.mergeWithOptions(x,{score:x.score+k}))}var C=E&&S?5:!E&&S?20:0;if(C>0){var T=jt(_,n.players);n=n.replacePlayer(Se.mergeWithOptions(T,{score:T.score+C}))}}}catch(t){g=!0,w=t}finally{try{!b&&O.return&&O.return()}finally{if(g)throw w}}}return n}}]),e}(),Be=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Me=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="StartPointChangeEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),Be(e,[{key:"handle",value:function(t){var e=t.boards[this.data.boardID].setStartPoint(this.data.newStartPoint),n=t.replaceBoard(e),r=!0,o=!1,a=void 0;try{for(var i,u=Et(n.players)[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var c=i.value,s=jt(c.id,n.playerBoards),f=!0,l=!1,p=void 0;try{for(var y,h=Et(s)[Symbol.iterator]();!(f=(y=h.next()).done);f=!0){var d=y.value;L(d.boardID,this.data.boardID)&&(n=n.replacePlayerBoard(pe.mergeWithOptions(d,{characterPosition:this.data.newStartPoint})))}}catch(t){l=!0,p=t}finally{try{!f&&h.return&&h.return()}finally{if(l)throw p}}}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}}]),e}(),Ne=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var We=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="StatusChangeEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),Ne(e,[{key:"handle",value:function(t){var e=t.boards[this.data.boardID],n=i.mergeWithOptions(e,{status:this.data.newStatus});return t.replaceBoard(n)}}]),e}(),Re=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Fe=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="ToggleWallEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),Re(e,[{key:"handle",value:function(t){var e=t.boards[this.data.boardID].toggleWallAtPosition(this.data.positionToToggle);return t.replaceBoard(e)}}]),e}(),Ue=Q(O);var Le=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},qe=Le;Le.handleEvent=function(t,e){return e.handle(t)},Le.makeListOfEvents=function(t){return nt(function(t){switch(t.type){case"InitialSetupEvent":return new Yt(t.data);case"InputEvent":return new Je(t.data);case"FailedMovementEvent":return new fe(t.data);case"MovementEvent":return new ce(t.data);case"SuccessfulMovementEvent":return new he(t.data);case"CommandEvent":return new Pe(t.data);case"DirectionEvent":return new Ge(t.data);case"PlayerNameChangeEvent":return new xe(t.data);case"StatusChangeEvent":return new We(t.data);case"SetPlayerBoardStatusToFinishedEvent":return new Ae(t.data);case"StartPointChangeEvent":return new Me(t.data);case"EndPointChangeEvent":return new _e(t.data);case"ToggleWallEvent":return new Fe(t.data)}},t)},Le.runEvents=function(t,e){return e=e||Ht.createGameState(),Ue(Le.handleEvent,e,t)};var ze=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Ge=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.type="DirectionEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Pe),ze(e,[{key:"handle",value:function(t){var e=Oe.getPositionToMoveInto(t,this.data.player,this.data.direction);return qe.runEvents(e,t)}}]),e}(),He=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Je=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.type="InputEvent",n.types=Jt(n.type,n.types),n.data=t,bt.dispatch(n.types,n.type,n.data),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,bt),He(e,[{key:"createEvent",value:function(){switch(this.data.command){case ae.MoveUp:var t={direction:ie.Up,player:this.data.player};return new Ge(t);case ae.MoveDown:var e={direction:ie.Down,player:this.data.player};return new Ge(e);case ae.MoveLeft:var n={direction:ie.Left,player:this.data.player};return new Ge(n);case ae.MoveRight:var r={direction:ie.Right,player:this.data.player};return new Ge(r);default:return new bt}}},{key:"handle",value:function(t){return this.createEvent().handle(t)}}]),e}(),Xe={ArrowUp:ae.MoveUp,ArrowDown:ae.MoveDown,ArrowLeft:ae.MoveLeft,ArrowRight:ae.MoveRight},Ye=function(t,e){var n=document.getElementById("board"),r=Et(t.boards)[0];n.innerHTML="<pre>"+r.boardAsString()+"</pre>";var o=t;window.addEventListener("keyup",function(t){var a=t.code;if(Xe.hasOwnProperty(a)){var i={command:Xe[a],player:e},u=new Je(i);o=u.handle(o),r=Et(o.boards)[0],console.log("gameState: ",o),console.log(""),n.innerHTML="<pre>"+r.boardAsString()+"</pre>"}})};window.eventBus=new ue,window.loggedEvents=[];window.eventBus.addListenerToMultipleEvents(["InitialSetupEvent","InputEvent"],function(t){window.loggedEvents.push(t),console.log("event, data: ",t.data)});var Ze=new $t,$e=[Ze.getInitialPlayerName(),Ze.getSize(),Ze.getStartPoint(),Ze.getEndPoint(),Ze.getPlayerIDs(),Ze.getBoardIDs()],Ke=new Yt({initialPlayerName:$e[0],size:$e[1],startPoint:$e[2],endPoint:$e[3],playerIDs:$e[4],boardIDs:$e[5]}).handle(Ht.createGameState());Ye(Ke,Et(Ke.players)[0])}]);
//# sourceMappingURL=game.js.map